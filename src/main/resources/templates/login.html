<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>余笙博客| 登录界面</title>
    <link href="/assets/css/potal/login.css" rel="stylesheet">

</head>
<body>
<div id="container" style="position: fixed">
    <div id="login-content">
        <h4>博客,记录生活中的点点滴滴!</h4>
        <p>在博客中,可以畅所欲言,可以学习IT最新的知识！</p>
        <label>账号</label><br>
        <input type="text" placeholder="请输入账号" id="floginacct" th:value="${session.loginacct}"><br>
        <label>密码</label><br>
        <input type="password" placeholder="请输入密码" id="fuserpswd" th:value="${session.userpswd}"><br>
        <div id="login-login">
            <input type="checkbox" id="remember"  th:checked="${session.remember eq '0'}">记住密码两周
            <button id="checkLogin">登录</button>
        </div>
    </div>
    <div id="login-footer">
        <a href="/toRegister">注册</a> | <a href="/toForget">忘记密码</a><br><br>
        <a href="/">返回首页</a>
    </div>
</div>
</body>

<script src="/plugins/jQuery/jQuery-2.1.4.min.js"></script>
<script src="/layer/layer.js"></script>
<script src="/jquery/jquery.form.js"></script>
<script>
    $("#checkLogin").click(function(){
        var floginacct = $("#floginacct");
        var fuserpswd = $("#fuserpswd");
        var beforeSend = -1;

        if(floginacct.val() == ""){
            layer.msg("请输入登录账号！", {time:1000, icon:5, shift:6});
            return false;
        }
        if(fuserpswd.val() == ""){
            layer.msg("请输入登录密码！", {time:1000, icon:5, shift:6});
            return false;
        }else{
            var loginacct =   floginacct.val();
            var userpswd = fuserpswd.val();
            var remember = $("#remember").is(":checked");
            $.ajax({
                type : "post",
                url : "/doLogin",
                data:{
                    "loginacct" : loginacct,
                    "userpswd" : userpswd,
                    "remember" : remember == true ? 0 : 1
                },
                beforeSend: function() {
                    loadingIndex = layer.msg('正在登录', {icon: 16});
                },
                success : function(result){
                    layer.close(beforeSend);
                    if(result.success){
                        window.location.href="/main"
                    }
                    else{
                        layer.msg("账号或密码错误！", {time:1000, icon:5, shift:6});
                    }
                }
            });
        }

    });
</script>
</html>